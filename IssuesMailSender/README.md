# IssuesMailSender

Скрипт IssuesMailSender собирает данные о замечаниях Vitro-CAD и отправляет их пользователям в виде сводки каждое утро. Замечания сгруппированы по открытым и закрытым, а также отсортированы по проектам.

## Требования

- PowerShell 5.1 или выше
- SharePoint PnP PowerShell модуль: `Install-Module SharePointPnPPowerShellOnline`

## Использование

1. Откройте файл скрипта и настройте переменные в начале файла (URL сайта, SMTP сервер, почта отправителя и т.д.)
2. Запустите скрипт в PowerShell с соответствующими правами доступа

## Описание работы скрипта

Скрипт выполняет следующие основные действия:

1. Подключается к SharePoint и системе VitroCAD с помощью модуля PnP PowerShell.
2. Собирает список пользователей из списка "Организационно-штатная структура" и их адреса электронной почты из списка "Физические лица".
3. Для каждого пользователя выполняются следующие действия:
   - Собираются открытые замечания, назначенные на пользователя.
   - Собираются закрытые замечания, автором которых является пользователь.
   - Генерируется HTML-таблица с информацией о замечаниях.
   - Отправляется письмо пользователю с таблицей замечаний.

При возникновении проблем с отправкой писем, скрипт повторяет попытку отправки до 4 раз.